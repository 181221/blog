<!DOCTYPE html>
<html lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="user-scalable=no width=device-width, initial-scale=1.0 maximum-scale=1.0"><title>A unit testing success story | Kyle Mathews</title><meta name="description" content="This summer I was accepted to Google Summer of Code to build a memetracker application for Drupal.
I want the Memetracker module to facilitate online conversations amongst distributed communities. For..."><meta property="twitter:account_id" content="10907062"><meta name="twitter:card" content="summary"><meta name="twitter:site" content="@kylemathews"><meta name="twitter:title" content="A unit testing success story | Kyle Mathews"><meta name="twitter:description" content="This summer I was accepted to Google Summer of Code to build a memetracker application for Drupal.
I want the Memetracker module to facilitate online conversations amongst distributed communities. For..."><meta property="og:title" content="A unit testing success story | Kyle Mathews"><meta property="og:type" content="article"><meta property="og:url" content="http://bricolage.io/a-unit-testing-success-story/"><meta property="og:description" content="This summer I was accepted to Google Summer of Code to build a memetracker application for Drupal.
I want the Memetracker module to facilitate online conversations amongst distributed communities. For..."><meta property="og:site_name" content="Bricolage — a blog by Kyle Mathews"><meta property="fb:admins" content="17830631"><link rel="shortcut icon"><style id="react-typography">/*! normalize.css v3.0.2 | MIT License | git.io/normalize */html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}article,aside,details,figcaption,figure,footer,header,hgroup,main,menu,nav,section,summary{display:block}audio,canvas,progress,video{display:inline-block;vertical-align:baseline}audio:not([controls]){display:none;height:0}[hidden],template{display:none}a{background-color:transparent}a:active,a:hover{outline:0}abbr[title]{border-bottom:1px dotted}b,strong{font-weight:700}dfn{font-style:italic}h1{font-size:2em;margin:.67em 0}mark{background:#ff0;color:#000}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sup{top:-.5em}sub{bottom:-.25em}img{border:0}svg:not(:root){overflow:hidden}figure{margin:1em 40px}hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}pre{overflow:auto}code,kbd,pre,samp{font-family:monospace,monospace;font-size:1em}button,input,optgroup,select,textarea{color:inherit;font:inherit;margin:0}button{overflow:visible}button,select{text-transform:none}button,html input[type=button],input[type=reset],input[type=submit]{-webkit-appearance:button;cursor:pointer}button[disabled],html input[disabled]{cursor:default}button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}input{line-height:normal}input[type=checkbox],input[type=radio]{box-sizing:border-box;padding:0}input[type=number]::-webkit-inner-spin-button,input[type=number]::-webkit-outer-spin-button{height:auto}input[type=search]{-webkit-appearance:textfield;-moz-box-sizing:content-box;-webkit-box-sizing:content-box;box-sizing:content-box}input[type=search]::-webkit-search-cancel-button,input[type=search]::-webkit-search-decoration{-webkit-appearance:none}fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}legend{border:0;padding:0}textarea{overflow:auto}optgroup{font-weight:700}table{border-collapse:collapse;border-spacing:0}td,th{padding:0}

html {
  box-sizing: border-box;
  font-size: 112.5%;
  line-height: 1.58333em;
  overflow-y: scroll;
}

*, *:before, *:after {
  box-sizing: inherit;
}

body {
  color: hsl(0,0%,20%);
  font-family: georgia, serif;
  font-weight: 400;
  word-wrap: break-word;
}

/* Make image responsive by default */
img {
  max-width: 100%;
}

/* All block elements get one rhythm of bottom margin. */
h1,
h2,
h3,
h4,
h5,
h6,
hgroup,
ul,
ol,
dl,
dd,
p,
figure,
pre,
table,
fieldset,
blockquote,
form,
noscript,
iframe,
img,
hr {
  margin: 0;
  margin-bottom: 1.58333rem;
  padding: 0;
}

blockquote {
  margin: 1.58333rem 3.95833rem;
}

b,
strong {
  font-weight: 700
}

hr {
  background: hsl(0,0%,80%);
  border: none;
  height: 1px;
  margin-bottom: calc(1.58333rem - 1px);
}

ol,
ul {
  list-style-position: outside;
  margin-left: 1.58333rem;
}

ul li,
ol li {
  padding-left: 0;
}

code,
kbd,
pre,
samp {
  font-size: 0.85rem;
  line-height: 1.58333rem;
}

table {
  font-size: 1rem;
  line-height: 2.375rem;
  width: 100%;
}

thead {
  text-align: left;
}

h1,
h2,
h3,
h4,
h5,
h6 {
  color: hsl(0,0%,20%);
  font-family: "Avenir Next", "Helvetica Neue", "Segoe UI", Helvetica, Arial, sans-serif;
  font-weight: 700;
}

h1 {
  font-size: 2.82843rem;
  line-height: 3.16667rem;
}

h2 {
  font-size: 2rem;
  line-height: 2.375rem;
}

h3 {
  font-size: 1.41421rem;
  line-height: 2.375rem;
}

h4 {
  font-size: 1.25992rem;
  line-height: 1.58333rem;
}

h5 {
  font-size: 1.12246rem;
  line-height: 1.58333rem;
}

h6 {
  font-size: 1rem;
  line-height: 1.58333rem;
}@media only screen and (max-width: 768px) {
h1 {
  font-size: 1.728rem;
  line-height: 2.375rem;
}

h2 {
  font-size: 1.44rem;
  line-height: 2.375rem;
}

h3 {
  font-size: 1.2rem;
  line-height: 1.58333rem;
}

h4 {
  font-size: 1.12924rem;
  line-height: 1.58333rem;
}

h5 {
  font-size: 1.06266rem;
  line-height: 1.58333rem;
}

h6 {
  font-size: 1rem;
  line-height: 1.58333rem;
}}

</style><style>body {
  color: rgb(66,66,66);
}
h1,h2,h3,h4,h5,h6 {
  color: rgb(44,44,44);
}
a {
  color: rgb(42,93,173);
  text-decoration: none;
}
a:hover {
  text-decoration: underline;
}</style></head><body class="landing-page"><div id="react-mount"><div style="max-width:38rem;margin-left:auto;margin-right:auto;padding:3.16667rem 0.79167rem;" data-reactid=".1z69mli7v9c" data-react-checksum="-1405732263"><h3 data-reactid=".1z69mli7v9c.0:0"><a style="text-decoration:none;color:inherit;" class="" href="/" data-reactid=".1z69mli7v9c.0:0.0">Bricolage</a></h3><div class="markdown" data-reactid=".1z69mli7v9c.0:1"><h1 data-reactid=".1z69mli7v9c.0:1.0">A unit testing success story</h1><div data-reactid=".1z69mli7v9c.0:1.1"><p>This summer I was accepted to <a href="http://en.wikipedia.org/wiki/Google_Summer_of_Code">Google Summer of Code</a> to <a href="/blog/2008/04/21/ive-been-accepted-to-google-summer-of-code">build a memetracker application</a> for <a href="http://drupal.org">Drupal</a>.</p>
<p>I want the <a href="http://drupal.org/project/memetracker">Memetracker module</a> to facilitate online conversations amongst distributed communities. For my dream to become reality, Memetracker will need help from many talented developers. This summer I’ll be setting a solid foundation for future development of the memetracker module. One important thing I’ll be doing is writing unit tests for all the functions of the memetracker. Unit tests, I’m convinced, is one thing Memetracker needs in order to ensure its long term success.</p>
<p>Unit tests are at the heart of <a href="http://en.wikipedia.org/wiki/Test-driven_development">Test Driven Development (TDD)</a>. TDD and unit tests when used have been shown to improve the quality of code and reduce bugs and regressions (see this <a href="http://www.lullabot.com/articles/introduction-unit-testing">excellent post</a> by <a href="http://robshouse.net/">Robert Douglass</a> for a full introduction to unit testing).</p>
<p>My brother <a href="http://www.linkedin.com/in/benjaminmathews">Ben</a> is a software engineer and has long preached to me the benefits of unit tests and TDD. When I started programming Memetracker, I agreed in principle with the benefits of unit tests but as I wanted to see something working more than write boring test code, I just dived into the coding without writing any unit tests. But as the lines of code accumulated and the complexity grew, weird bugs started cropping up and having a solid coverage of unit tests as a safety net started sounding better and better.</p>
<p>So I stopped coding and spent a day studying unit testing and <a href="http://drupal.org/project/simpletest">SimpleTest</a> (the testing framework Drupal uses). There was a painful learning curve to wrap my head around the concepts but just a few days of coding with unit tests has made me a convert.</p>
<p>A quick example of how SimpleTest has helped me improve the quality of my code.</p>
<p>Memetracker tries to present to readers the most interesting memes (conversations around a topic) to readers on a web page. To learn which memes are interesting, Memetracker records the articles people click on from the memebrowsing page. By counting clicks, memetracker can calculate an interestingness score for the different memes and from that score, determine which memes to display and in what order.</p>
<p>When a person clicks on a article, that information is sent from the browser to the memetracker module. In memetracker.module is a function, memetracker_set_click(), which saves the click information to a table in the database.</p>
<p>I wanted to make sure this function works correctly so I wrote a unit test which sent a fake click to the memetracker_set_click function and then tested that the click was actually saved to the database.</p>
<p>So I wrote the test. . . and it worked!</p>
<p><a href="http://www.flickr.com/photos/82268668@N00/2625633427/" title="click_test by kylenumber5, on Flickr"><img src="./2625633427_4fa80978a2_o.png" alt="click_test"></a></p>
<p>But wait a second – I thought – it shouldn’t of worked. To save the click data a memetracker object has to be loaded which then does the actual saving of the click information. But when I wrote the unit test, I had made up an id for the memetracker object. All information for different memetracker objects are stored in the database (one website can have multiple memetrackers). If a memetracker didn’t exist in the database, it shouldn’t be loaded.</p>
<p>I had already written some code to validate that a memetracker object existed before loading but somehow that validation wasn’t working. I looked at the validation code and quickly found the problem. Problem solved, and to ensure this didn’t happen again I wrote a new unit test to ensure my validation code works correctly in the future.</p>
<p>Unit tests are valuable for any coding project longer than a few lines. Once you get past the learning curve, writing new tests are easy. And it’s a great feeling after making changes to run my tests and know in seconds everything is still working as it should.</p>
<p>To learn more about unit testing, read <a href="http://www.lullabot.com/about/angiebyron">Angie Bryon’s (webchick)</a> great blog post about how <a href="http://www.lullabot.com/articles/drupal-module-developer-guide-simpletest">unit tests let you to refactor without fear</a>. The Lullabot crew had a <a href="http://www.lullabot.com/audiocast/podcast-59-simpletest">recent podcast</a> on the wonders of unit testing. And lastly, there’s some great documentation being collected <a href="http://groups.drupal.org/node/11020">here</a>.</p>
<p>Happy unit testing!</p>
</div><em style="display:block;margin-bottom:3.16667rem;" data-reactid=".1z69mli7v9c.0:1.2"><span data-reactid=".1z69mli7v9c.0:1.2.0">Posted </span><span data-reactid=".1z69mli7v9c.0:1.2.1">July 1, 2008</span></em><hr style="margin-bottom:3.16667rem;" data-reactid=".1z69mli7v9c.0:1.3"><noscript data-reactid=".1z69mli7v9c.0:1.4"></noscript><p style="margin-bottom:9.5rem;" data-reactid=".1z69mli7v9c.0:1.5"><img src="/kyle-round-small-pantheon.jpg" style="float:left;margin-right:0.39583rem;margin-bottom:0;width:3.16667rem;height:3.16667rem;" data-reactid=".1z69mli7v9c.0:1.5.0"><strong data-reactid=".1z69mli7v9c.0:1.5.1">Kyle Mathews</strong><span data-reactid=".1z69mli7v9c.0:1.5.2"> lives and works in San Francisco building useful things. </span><a href="https://twitter.com/kylemathews" data-reactid=".1z69mli7v9c.0:1.5.3">You should follow him on Twitter</a></p><div title="A unit testing success story" data-reactid=".1z69mli7v9c.0:1.6"><div id="disqus_thread" data-reactid=".1z69mli7v9c.0:1.6.0"></div><noscript data-reactid=".1z69mli7v9c.0:1.6.1"><span data-reactid=".1z69mli7v9c.0:1.6.1.0"><span data-reactid=".1z69mli7v9c.0:1.6.1.0.0">Please enable JavaScript to view the </span><a href="http://disqus.com/?ref_noscript" data-reactid=".1z69mli7v9c.0:1.6.1.0.1">comments powered by Disqus.</a></span></noscript><a href="http://disqus.com" class="dsq-brlink" data-reactid=".1z69mli7v9c.0:1.6.2"><span data-reactid=".1z69mli7v9c.0:1.6.2.0">blog comments powered by </span><span class="logo-disqus" data-reactid=".1z69mli7v9c.0:1.6.2.1">Disqus</span></a></div></div><span style="display:block;clear:both;" data-reactid=".1z69mli7v9c.1"> </span></div></div><script src="/bundle.js"></script><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-774017-3', 'auto');
ga('send', 'pageview');</script></body></html>